!function(e){function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var t={};n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=5)}({0:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){var e=location.origin+"/ksc",n=function(n,t){$.ajax(e+"/api/Category",{type:"GET",data:{categoryId:t}}).then(function(e){var t=JSON.parse(e);$("#category-list").append(n(t))})},t=function(n){$listItem=$(n.currentTarget).closest("li"),location.href=e+"/home?categoryId="+$listItem.data("id")+"&categoryName="+$(n.currentTarget).text()},i=function(){var n=handlebarsHelper("#rank-body-template");$.ajax(e+"/api/Rank",{type:"GET",data:{ranker:!0}}).then(function(e){var t=JSON.parse(e),i=t.ranker;i.map(function(e,n){e.rank=++n}),$("#rank-body").html(n(i))})};return{init:function(){var e=handlebarsHelper("#nav-category-template"),o=$("#rank-aside").data("category-id");$("#category-list").on("click",".category-item>a",t),n(e,o),i()}}}(),o=function(){function e(){$(".btn.login").on("click",t),$(".btn.question").on("click",r),$(".logout").on("click",o),$("button.signup").on("click",a),$("a.btn-signup").on("click",a),$("button.mypage").on("click",i),$("#search-btn").on("click",function(e){n($(e.currentTarget).closest("div.input-group").find("input").val())})}function n(e){location.href=s+"/search?search="+e+"&category=all"}function t(){location.href=s+"/login"}function i(){location.href=s+"/my"}function o(e){location.href=s+"/public/logout.php"}function a(){location.href=s+"/signup"}function r(){location.href=s+"/write"}var s=location.origin+"/ksc";return{init:e}}();n.AsideModule=i,n.CommonModule=o},5:function(e,n,t){"use strict";var i=t(0),o=function(){function e(){$("div.reply-box").on("click","a.vote.up",function(e){e.preventDefault(),a.call(this,1,h,$(this).closest(".reply-card").data("id"))}),$("div.reply-box").on("click","a.vote.down",function(e){e.preventDefault(),a.call(this,-1,h,$(this).closest(".reply-card").data("id"))})}function n(){$("#question-container").on("click",".view-opinions",function(e){$(e.currentTarget).closest("#question-container").find("div.opinion-list").toggleClass("hide")}),$("div.reply-box").on("click",".btn.view-opinions",function(e){$(e.currentTarget).closest(".reply-card.container").find("div.opinion-list").toggleClass("hide")})}function t(){$("#question-container").on("click","button.btn.reply",function(e){if(""===h)return alert("로그인이 필요합니다.");$(this).hasClass("btn-danger")?$(this).text("답글달기"):$(this).text("취소"),$(this).toggleClass("btn-danger"),$("#write-box").toggle("blind")}),$("#btn-post-reply").on("click",function(e){if(""===h)return alert("로그인이 필요합니다.");var n=$("div.write.header>textarea").val(),t=$("div.write.content>textarea").val();$.ajax(r+"/api/Controllers/Answer.php",{type:"POST",contentType:"application/x-www-form-urlencoded",data:{answer:{title:n,content:t,question_id:f,user_id:h}}}).then(function(e){var n=JSON.parse(e);if(n.success){var t=n.data;$("div.reply-box").append(l([t])),$("div.reply-box>.reply-card:last-child").append(p()),$("div.reply-box>.reply-card:last-child").find("textarea").height(21*t.content.split(v).length),$("#write-box").toggle("blind"),$("button.btn.reply").toggleClass("btn-danger").text("답글달기"),$("div.reply-card.container").each(function(e,n){var t=$(n).find("span.user-type");"전문가"===t.text()&&(t.addClass("special"),t.closest("div.page-header").find(".img-div").removeClass("hide"))}),alert("답변이 등록되었습니다!")}else alert("등록이 실패하였습니다.")},function(e){})})}function i(){o(),e(),n(),t(),$("div.reply-box").on("click",".select-btn",function(e){if(!g&&confirm("채택 하시겠습니까?(한 번 채택하시면 수정할 수 없습니다)")){$(e.currentTarget).addClass("selected");var n=$(e.currentTarget).closest(".reply-card").data("id");g=!0,$(".reply-box").find(".select-btn:not(.selected)").hide(),$(e.currentTarget).closest(".reply-card").find("span").removeClass("hide"),$.ajax(r+"/api/Answer/"+n,{type:"PUT",contentType:"application/json",data:JSON.stringify({selection:!0,questionId:f})}).then(function(e){alert("채택이 완료되었습니다.")})}}),$("div.reply-box").on("click",".delete",function(e){if(confirm("답변을 삭제하시겠습니까?")){var n=$(e.currentTarget).closest(".reply-card"),t=n.data("id");$.ajax(r+"/api/Answer/"+t,{type:"DELETE"}).then(function(e){e=JSON.parse(e),alert(e.message),this.remove()}.bind(n))}}),$("#question-container").on("click",".delete",function(e){$.ajax(s+"/my/Question/"+f,{type:"DELETE"}).then(function(e){var n=JSON.parse(e);alert(n.messages),location.href=r+"/home"})}),$("#question-container").on("click",".edit",function(e){location.href=r+"/update/"+f})}function o(){$.ajax(s+"/Question/"+f,{type:"GET",contentType:"application/json"}).then(function(e){var n=JSON.parse(e),t=n.question,i=n.answers,o={};o.question_id=t.question_id,o.opinions=n.questionOpinions;var a=n.answerOpinions;t.opinion_cnt=o.opinions.length,i.forEach(function(e,n){a[parseInt(e.answer_id)]?e.opinion_cnt=a[parseInt(e.answer_id)].length:e.opinion_cnt=0}),t.tags=t.tags.split("/"),i.forEach(function(e){e.height=21*e.content.split(v).length}),$("div.question.container").removeClass("hide"),$("div.question.container").data("id",t.question_id),$("div.question.container").html(c(t)),$("div.question.container").append(d(o)),$("div.reply-box").html(l(i)),$("div.reply-card.container").each(function(e,n){1===$(n).data("selection")&&($(n).addClass("selected-answer"),$(n).find(".select-btn").removeClass("hide"),$(n).find(".select-btn").addClass("selected"),$(n).find(".selection-text").removeClass("hide")),$(n).append(p(a[$(n).data("id")]))});var r=t.content;i.content;$("div.question.container").find("textarea").height(21*r.split(v).length),$("div.reply-card.container").each(function(e,n){var t=$(n).find("span.user-type");"전문가"===t.text()&&(t.addClass("special"),t.closest("div.page-header").find("div.img-div").removeClass("hide"))}),$("div.question.container").find(".header-group").data("id")===h&&($("div.question.container").find(".btn-group").removeClass("not-visible"),0===parseInt(t.selected_answer_id)&&$(".select-btn").removeClass("hide")),$("div.reply-box").find("span.answer-author").each(function(e,n){$(n).text()!==h&&$(n).closest(".reply-card.container").find(".edit-btn-group").addClass("not-visible")}),$(".vote-group").each(function(e,n){var t=$(n),i=t.data("value");void 0!==i&&(parseInt(i)>0?t.find(".up").css("border-color","blue"):t.find(".down").css("border-color","red"))})}).then(function(){$("div.opinion-list").on("click","button[type='submit']",function(e){if(""===h)return alert("로그인이 필요합니다.");e.preventDefault();var n=$(e.delegateTarget).find("form"),t=n.closest(".container").data("id"),i=n.find("input[name='content']").val(),o={content:i};n.hasClass("question")?o.questionId=t:(o.questionId=location.href.split("/").pop(),o.answerId=t),$.ajax("/ksc/api/Opinion",{type:"POST",data:o}).then(function(e){var n=JSON.parse(e);n.success?(alert("댓글이 등록되었습니다."),$(this).append(u(n.myopinion)),$(this).removeClass("hide")):alert("댓글 등록에 실패하였습니다.")}.bind(n.closest(".opinion-list").find("ul.opinion-list")))})})}function a(e,n,t){if(""===n)return alert("로그인이 필요합니다.");$.ajax(s+"/Answer/"+t+"/vote",{type:"PUT",contentType:"application/json",data:JSON.stringify({score:e,userId:n,answerId:t})}).then(function(e){var n=JSON.parse(e);if(n.success){var t=parseInt($(this).find("span").text().trim());$(this).find("span").text(++t),$(this).hasClass("up")?$(this).css("border-color","blue"):$(this).css("border-color","red")}window.alert(n.message)}.bind(this))}var r=location.origin+"/ksc",s="/ksc/api",c=handlebarsHelper("#question-template"),l=handlebarsHelper("#answer-template"),d=handlebarsHelper("#opinion-template"),p=handlebarsHelper("#opinion-answer-template"),u=handlebarsHelper("#opinion-item-template"),f=parseInt(location.href.split("/").pop()),h=$("#welcome").data("id")||"",v=/\r\n|\r|\n/g,g=!1;return{init:i}}();$(document).ready(function(){i.AsideModule.init(),i.CommonModule.init(),o.init()})}});